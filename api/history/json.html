


<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="ja">
  <head>
    <meta charset="utf-8" />
    <title>History Backend JSON -- xonsh.history.json &#8212; xonsh 0.8.12 ドキュメント</title>
    <link rel="stylesheet" href="../../_static/numpy_friendly.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noticia+Text|Open+Sans|Droid+Sans+Mono" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="../../_static/translations.js"></script>
    <script type="text/javascript" src="../../_static/jquery.cookie.js"></script>
    <script type="text/javascript" src="../../_static/cloud.base.js"></script>
    <script type="text/javascript" src="../../_static/cloud.js"></script>
    <link rel="shortcut icon" href="../../_static/magic_conch.ico"/>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="検索" href="../../search.html" />
    <link rel="next" title="History Backend Sqlite -- xonsh.history.sqlite" href="sqlite.html" />
    <link rel="prev" title="History Main Entry Points -- xonsh.history.main" href="main.html" />
     
        <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="canonical" href="http://xon.sh/api/history/json.html"/>

  </head><body>
    <div class="relbar-top">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="sqlite.html" title="History Backend Sqlite -- xonsh.history.sqlite"
             accesskey="N">次へ</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="main.html" title="History Main Entry Points -- xonsh.history.main"
             accesskey="P">前へ</a> &nbsp; &nbsp;</li>
    <li><a href="../../sidebar.html">xonsh 0.8.12 ドキュメント</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Xonsh シェル</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Xonsh API</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" accesskey="U">Xonsh History API</a> &#187;</li> 
      </ul>
    </div>
    </div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-xonsh.history.json">
<span id="history-backend-json-xonsh-history-json"></span><span id="xonsh-history-json"></span><h1>History Backend JSON -- <a class="reference internal" href="#module-xonsh.history.json" title="xonsh.history.json"><code class="xref py py-mod docutils literal notranslate"><span class="pre">xonsh.history.json</span></code></a><a class="headerlink" href="#module-xonsh.history.json" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>Implements JSON version of xonsh history backend.</p>
<dl class="class">
<dt id="xonsh.history.json.JsonCommandField">
<em class="property">class </em><code class="descclassname">xonsh.history.json.</code><code class="descname">JsonCommandField</code><span class="sig-paren">(</span><em>field</em>, <em>hist</em>, <em>default=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonCommandField"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonCommandField" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>A field in the 'cmds' portion of history.</p>
<p>Represents a field in the 'cmds' portion of history.</p>
<p>Will query the buffer for the relevant data, if possible. Otherwise it
will lazily acquire data from the file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>field</strong><span class="classifier">str</span></dt><dd><p>The name of the field to query.</p>
</dd>
<dt><strong>hist</strong><span class="classifier">History object</span></dt><dd><p>The history object to query.</p>
</dd>
<dt><strong>default</strong><span class="classifier">optional</span></dt><dd><p>The default value to return if key is not present.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="xonsh.history.json.JsonCommandField.i_am_at_the_front">
<code class="descname">i_am_at_the_front</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonCommandField.i_am_at_the_front"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonCommandField.i_am_at_the_front" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Tests if the command field is at the front of the queue.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="xonsh.history.json.JsonHistory">
<em class="property">class </em><code class="descclassname">xonsh.history.json.</code><code class="descname">JsonHistory</code><span class="sig-paren">(</span><em>filename=None</em>, <em>sessionid=None</em>, <em>buffersize=100</em>, <em>gc=True</em>, <em>**meta</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistory"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistory" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Xonsh history backend implemented with JSON files.</p>
<p>JsonHistory implements two extra actions: <code class="docutils literal notranslate"><span class="pre">diff</span></code>, and <code class="docutils literal notranslate"><span class="pre">replay</span></code>.</p>
<p>Represents a xonsh session's history as an in-memory buffer that is
periodically flushed to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str, optional</span></dt><dd><p>Location of history file, defaults to
<code class="docutils literal notranslate"><span class="pre">$XONSH_DATA_DIR/xonsh-{sessionid}.json</span></code>.</p>
</dd>
<dt><strong>sessionid</strong><span class="classifier">int, uuid, str, optional</span></dt><dd><p>Current session identifier, will generate a new sessionid if not
set.</p>
</dd>
<dt><strong>buffersize</strong><span class="classifier">int, optional</span></dt><dd><p>Maximum buffersize in memory.</p>
</dd>
<dt><strong>meta</strong><span class="classifier">optional</span></dt><dd><p>Top-level metadata to store along with the history. The kwargs
'cmds' and 'sessionid' are not allowed and will be overwritten.</p>
</dd>
<dt><strong>gc</strong><span class="classifier">bool, optional</span></dt><dd><p>Run garbage collector flag.</p>
</dd>
</dl>
</dd>
</dl>
<dl class="method">
<dt id="xonsh.history.json.JsonHistory.all_items">
<code class="descname">all_items</code><span class="sig-paren">(</span><em>self</em>, <em>newest_first=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistory.all_items"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistory.all_items" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Returns all history as found in XONSH_DATA_DIR.</p>
<p>yield format: {'inp': cmd, 'rtn': 0, ...}</p>
</dd></dl>

<dl class="method">
<dt id="xonsh.history.json.JsonHistory.append">
<code class="descname">append</code><span class="sig-paren">(</span><em>self</em>, <em>cmd</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistory.append"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistory.append" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Appends command to history. Will periodically flush the history to file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>cmd</strong><span class="classifier">dict</span></dt><dd><p>This dict contains information about the command that is to be
added to the history list. It should contain the keys <code class="docutils literal notranslate"><span class="pre">inp</span></code>,
<code class="docutils literal notranslate"><span class="pre">rtn</span></code> and <code class="docutils literal notranslate"><span class="pre">ts</span></code>. These key names mirror the same names defined
as instance variables in the <code class="docutils literal notranslate"><span class="pre">HistoryEntry</span></code> class.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hf</strong><span class="classifier">JsonHistoryFlusher or None</span></dt><dd><p>The thread that was spawned to flush history</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xonsh.history.json.JsonHistory.flush">
<code class="descname">flush</code><span class="sig-paren">(</span><em>self</em>, <em>at_exit=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistory.flush"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistory.flush" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Flushes the current command buffer to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>at_exit</strong><span class="classifier">bool, optional</span></dt><dd><p>Whether the JsonHistoryFlusher should act as a thread in the
background, or execute immediately and block.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><strong>hf</strong><span class="classifier">JsonHistoryFlusher or None</span></dt><dd><p>The thread that was spawned to flush history</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xonsh.history.json.JsonHistory.info">
<code class="descname">info</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistory.info"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistory.info" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>A collection of information about the shell history.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt>dict or collections.OrderedDict</dt><dd><p>Contains history information as str key pairs.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="xonsh.history.json.JsonHistory.items">
<code class="descname">items</code><span class="sig-paren">(</span><em>self</em>, <em>newest_first=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistory.items"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistory.items" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Display history items of current session.</p>
</dd></dl>

<dl class="method">
<dt id="xonsh.history.json.JsonHistory.run_gc">
<code class="descname">run_gc</code><span class="sig-paren">(</span><em>self</em>, <em>size=None</em>, <em>blocking=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistory.run_gc"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistory.run_gc" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Run the garbage collector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>size: None or tuple of a int and a string</strong></dt><dd><p>Determines the size and units of what would be allowed to remain.</p>
</dd>
<dt><strong>blocking: bool</strong></dt><dd><p>If set blocking, then wait until gc action finished.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="xonsh.history.json.JsonHistoryFlusher">
<em class="property">class </em><code class="descclassname">xonsh.history.json.</code><code class="descname">JsonHistoryFlusher</code><span class="sig-paren">(</span><em>filename</em>, <em>buffer</em>, <em>queue</em>, <em>cond</em>, <em>at_exit=False</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistoryFlusher"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistoryFlusher" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Flush shell history to disk periodically.</p>
<p>Thread for flushing history.</p>
<dl class="method">
<dt id="xonsh.history.json.JsonHistoryFlusher.dump">
<code class="descname">dump</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistoryFlusher.dump"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistoryFlusher.dump" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Write the cached history to external storage.</p>
</dd></dl>

<dl class="method">
<dt id="xonsh.history.json.JsonHistoryFlusher.i_am_at_the_front">
<code class="descname">i_am_at_the_front</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistoryFlusher.i_am_at_the_front"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistoryFlusher.i_am_at_the_front" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Tests if the flusher is at the front of the queue.</p>
</dd></dl>

<dl class="method">
<dt id="xonsh.history.json.JsonHistoryFlusher.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistoryFlusher.run"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistoryFlusher.run" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Method representing the thread's activity.</p>
<p>You may override this method in a subclass. The standard run() method
invokes the callable object passed to the object's constructor as the
target argument, if any, with sequential and keyword arguments taken
from the args and kwargs arguments, respectively.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="xonsh.history.json.JsonHistoryGC">
<em class="property">class </em><code class="descclassname">xonsh.history.json.</code><code class="descname">JsonHistoryGC</code><span class="sig-paren">(</span><em>wait_for_shell=True</em>, <em>size=None</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistoryGC"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistoryGC" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Shell history garbage collection.</p>
<p>Thread responsible for garbage collecting old history.</p>
<p>May wait for shell (and for xonshrc to have been loaded) to start work.</p>
<dl class="method">
<dt id="xonsh.history.json.JsonHistoryGC.files">
<code class="descname">files</code><span class="sig-paren">(</span><em>self</em>, <em>only_unlocked=False</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistoryGC.files"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistoryGC.files" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Find and return the history files. Optionally locked files may be
excluded.</p>
<p>This is sorted by the last closed time. Returns a list of
(timestamp, number of cmds, file name) tuples.</p>
</dd></dl>

<dl class="method">
<dt id="xonsh.history.json.JsonHistoryGC.run">
<code class="descname">run</code><span class="sig-paren">(</span><em>self</em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/xonsh/history/json.html#JsonHistoryGC.run"><span class="viewcode-link">[ソース]</span></a><a class="headerlink" href="#xonsh.history.json.JsonHistoryGC.run" title="この定義へのパーマリンク">¶</a></dt>
<dd><p>Method representing the thread's activity.</p>
<p>You may override this method in a subclass. The standard run() method
invokes the callable object passed to the object's constructor as the
target argument, if any, with sequential and keyword arguments taken
from the args and kwargs arguments, respectively.</p>
</dd></dl>

</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
        <p class="logo"><a href="../../sidebar.html" title="sidebar">
          <img class="logo" src="../../_static/ascii_conch_part_transparent_tight.png" alt="Logo"/>
        </a></p>
  <div class="sphinxprev">
    <h4>Previous page</h4>
    <p class="topless"><a href="main.html"
                          title="Previous page">&larr; History Main Entry Points -- <code class="xref py py-mod docutils literal notranslate"><span class="pre">xonsh.history.main</span></code></a></p>
  </div>
  <div class="sphinxnext">
    <h4>Next page</h4>
    <p class="topless"><a href="sqlite.html"
                          title="Next page">&rarr; History Backend Sqlite -- <code class="xref py py-mod docutils literal notranslate"><span class="pre">xonsh.history.sqlite</span></code></a></p>
  </div>
  <div role="note" aria-label="source link">
    <h3>このページ</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/api/history/json.rst.txt"
            rel="nofollow">ソースコードを表示</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>クイック検索</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
    
    
        <div class="sidebar-toggle-group no-js">
            
            <button class="sidebar-toggle" id="sidebar-hide" title="Hide the sidebar menu">
                 «
                <span class="show-for-small">hide menu</span>
                
            </button>
            <button class="sidebar-toggle" id="sidebar-show" title="Show the sidebar menu">
                
                <span class="show-for-small">menu</span>
                <span class="hide-for-small">sidebar</span>
                 »
            </button>
        </div>
    
      <div class="clearer"></div>
    </div>
    <div class="relbar-bottom">
        
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Pythonモジュール索引"
             >モジュール</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="sqlite.html" title="History Backend Sqlite -- xonsh.history.sqlite"
             >次へ</a> &nbsp; &nbsp;</li>
        <li class="right" >
          <a href="main.html" title="History Main Entry Points -- xonsh.history.main"
             >前へ</a> &nbsp; &nbsp;</li>
    <li><a href="../../sidebar.html">xonsh 0.8.12 ドキュメント</a> &#187;</li>

          <li class="nav-item nav-item-1"><a href="../../index.html" >Xonsh シェル</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../index.html" >Xonsh API</a> &#187;</li>
          <li class="nav-item nav-item-3"><a href="index.html" >Xonsh History API</a> &#187;</li> 
      </ul>
    </div>
    </div>

    <div class="footer" role="contentinfo">
        &#169; Copyright 2015, Anthony Scopatz.
      このドキュメントは <a href="http://sphinx-doc.org/">Sphinx</a> 2.0.1 で生成しました。
    </div>
    <!-- cloud_sptheme 1.4 -->
  </body>
</html>